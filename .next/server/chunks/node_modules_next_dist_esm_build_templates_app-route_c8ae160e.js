module.exports=[59579,e=>{"use strict";var t=e.i(747909),o=e.i(174017),n=e.i(996250),a=e.i(759756),i=e.i(561916),l=e.i(114444),r=e.i(837092),s=e.i(869741),u=e.i(316795),d=e.i(487718),c=e.i(995169),p=e.i(47587),g=e.i(666012),h=e.i(570101),m=e.i(626937),f=e.i(10372),v=e.i(193695);e.i(52474);var y=e.i(600220),b=e.i(62789),C=e.i(975789);e.i(274444);var R=e.i(410584),z=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({error:R.z.object({code:R.z.number().nullable(),message:R.z.string(),status:R.z.string()})}))),E=(0,b.createJsonErrorResponseHandler)({errorSchema:z,errorToMessage:e=>e.error.message}),T=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({outputDimensionality:R.z.number().optional(),taskType:R.z.enum(["SEMANTIC_SIMILARITY","CLASSIFICATION","CLUSTERING","RETRIEVAL_DOCUMENT","RETRIEVAL_QUERY","QUESTION_ANSWERING","FACT_VERIFICATION","CODE_RETRIEVAL_QUERY"]).optional()}))),S=class{constructor(e,t){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:o,providerOptions:n}){let a=await (0,b.parseProviderOptions)({provider:"google",providerOptions:n,schema:T});if(e.length>this.maxEmbeddingsPerCall)throw new C.TooManyEmbeddingValuesForCallError({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let i=(0,b.combineHeaders)(await (0,b.resolve)(this.config.headers),t);if(1===e.length){let{responseHeaders:t,value:n,rawValue:l}=await (0,b.postJsonToApi)({url:`${this.config.baseURL}/models/${this.modelId}:embedContent`,headers:i,body:{model:`models/${this.modelId}`,content:{parts:[{text:e[0]}]},outputDimensionality:null==a?void 0:a.outputDimensionality,taskType:null==a?void 0:a.taskType},failedResponseHandler:E,successfulResponseHandler:(0,b.createJsonResponseHandler)(I),abortSignal:o,fetch:this.config.fetch});return{embeddings:[n.embedding.values],usage:void 0,response:{headers:t,body:l}}}let{responseHeaders:l,value:r,rawValue:s}=await (0,b.postJsonToApi)({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:i,body:{requests:e.map(e=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:e}]},outputDimensionality:null==a?void 0:a.outputDimensionality,taskType:null==a?void 0:a.taskType}))},failedResponseHandler:E,successfulResponseHandler:(0,b.createJsonResponseHandler)(x),abortSignal:o,fetch:this.config.fetch});return{embeddings:r.embeddings.map(e=>e.values),usage:void 0,response:{headers:l,body:s}}}},x=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({embeddings:R.z.array(R.z.object({values:R.z.array(R.z.number())}))}))),I=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({embedding:R.z.object({values:R.z.array(R.z.number())})})));function w(e){var t;if(null==e||null!=(t=e)&&"object"==typeof t&&"object"===t.type&&(null==t.properties||0===Object.keys(t.properties).length)&&!t.additionalProperties)return;if("boolean"==typeof e)return{type:"boolean",properties:{}};let{type:o,description:n,required:a,properties:i,items:l,allOf:r,anyOf:s,oneOf:u,format:d,const:c,minLength:p,enum:g}=e,h={};if(n&&(h.description=n),a&&(h.required=a),d&&(h.format=d),void 0!==c&&(h.enum=[c]),o&&(Array.isArray(o)?o.includes("null")?(h.type=o.filter(e=>"null"!==e)[0],h.nullable=!0):h.type=o:"null"===o?h.type="null":h.type=o),void 0!==g&&(h.enum=g),null!=i&&(h.properties=Object.entries(i).reduce((e,[t,o])=>(e[t]=w(o),e),{})),l&&(h.items=Array.isArray(l)?l.map(w):w(l)),r&&(h.allOf=r.map(w)),s)if(s.some(e=>"object"==typeof e&&(null==e?void 0:e.type)==="null")){let e=s.filter(e=>"object"!=typeof e||(null==e?void 0:e.type)!=="null");if(1===e.length){let t=w(e[0]);"object"==typeof t&&(h.nullable=!0,Object.assign(h,t))}else h.anyOf=e.map(w),h.nullable=!0}else h.anyOf=s.map(w);return u&&(h.oneOf=u.map(w)),void 0!==p&&(h.minLength=p),h}function O(e){return e.includes("/")?e:`models/${e}`}var _=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({responseModalities:R.z.array(R.z.enum(["TEXT","IMAGE"])).optional(),thinkingConfig:R.z.object({thinkingBudget:R.z.number().optional(),includeThoughts:R.z.boolean().optional()}).optional(),cachedContent:R.z.string().optional(),structuredOutputs:R.z.boolean().optional(),safetySettings:R.z.array(R.z.object({category:R.z.enum(["HARM_CATEGORY_UNSPECIFIED","HARM_CATEGORY_HATE_SPEECH","HARM_CATEGORY_DANGEROUS_CONTENT","HARM_CATEGORY_HARASSMENT","HARM_CATEGORY_SEXUALLY_EXPLICIT","HARM_CATEGORY_CIVIC_INTEGRITY"]),threshold:R.z.enum(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"])})).optional(),threshold:R.z.enum(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"]).optional(),audioTimestamp:R.z.boolean().optional(),labels:R.z.record(R.z.string(),R.z.string()).optional(),mediaResolution:R.z.enum(["MEDIA_RESOLUTION_UNSPECIFIED","MEDIA_RESOLUTION_LOW","MEDIA_RESOLUTION_MEDIUM","MEDIA_RESOLUTION_HIGH"]).optional(),imageConfig:R.z.object({aspectRatio:R.z.enum(["1:1","2:3","3:2","3:4","4:3","4:5","5:4","9:16","16:9","21:9"]).optional()}).optional()})));function A({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var M=class{constructor(e,t){var o;this.specificationVersion="v2",this.modelId=e,this.config=t,this.generateId=null!=(o=t.generateId)?o:b.generateId}get provider(){return this.config.provider}get supportedUrls(){var e,t,o;return null!=(o=null==(t=(e=this.config).supportedUrls)?void 0:t.call(e))?o:{}}async getArgs({prompt:e,maxOutputTokens:t,temperature:o,topP:n,topK:a,frequencyPenalty:i,presencePenalty:l,stopSequences:r,responseFormat:s,seed:u,tools:d,toolChoice:c,providerOptions:p}){var g,h;let m=[],f=await (0,b.parseProviderOptions)({provider:"google",providerOptions:p,schema:_});(null==(g=null==f?void 0:f.thinkingConfig)?void 0:g.includeThoughts)!==!0||this.config.provider.startsWith("google.vertex.")||m.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});let v=this.modelId.toLowerCase().startsWith("gemma-"),{contents:y,systemInstruction:R}=function(e,t){var o;let n=[],a=[],i=!0,l=null!=(o=null==t?void 0:t.isGemmaModel)&&o;for(let{role:t,content:o}of e)switch(t){case"system":if(!i)throw new C.UnsupportedFunctionalityError({functionality:"system messages are only supported at the beginning of the conversation"});n.push({text:o});break;case"user":{i=!1;let e=[];for(let t of o)switch(t.type){case"text":e.push({text:t.text});break;case"file":{let o="image/*"===t.mediaType?"image/jpeg":t.mediaType;e.push(t.data instanceof URL?{fileData:{mimeType:o,fileUri:t.data.toString()}}:{inlineData:{mimeType:o,data:(0,b.convertToBase64)(t.data)}})}}a.push({role:"user",parts:e});break}case"assistant":i=!1,a.push({role:"model",parts:o.map(e=>{var t,o,n,a,i,l;switch(e.type){case"text":return 0===e.text.length?void 0:{text:e.text,thoughtSignature:null==(o=null==(t=e.providerOptions)?void 0:t.google)?void 0:o.thoughtSignature};case"reasoning":return 0===e.text.length?void 0:{text:e.text,thought:!0,thoughtSignature:null==(a=null==(n=e.providerOptions)?void 0:n.google)?void 0:a.thoughtSignature};case"file":if("image/png"!==e.mediaType)throw new C.UnsupportedFunctionalityError({functionality:"Only PNG images are supported in assistant messages"});if(e.data instanceof URL)throw new C.UnsupportedFunctionalityError({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:e.mediaType,data:(0,b.convertToBase64)(e.data)}};case"tool-call":return{functionCall:{name:e.toolName,args:e.input},thoughtSignature:null==(l=null==(i=e.providerOptions)?void 0:i.google)?void 0:l.thoughtSignature}}}).filter(e=>void 0!==e)});break;case"tool":{i=!1;let e=[];for(let t of o){let o=t.output;if("content"===o.type)for(let n of o.value)switch(n.type){case"text":e.push({functionResponse:{name:t.toolName,response:{name:t.toolName,content:n.text}}});break;case"media":e.push({inlineData:{mimeType:n.mediaType,data:n.data}},{text:"Tool executed successfully and returned this image as a response"});break;default:e.push({text:JSON.stringify(n)})}else e.push({functionResponse:{name:t.toolName,response:{name:t.toolName,content:o.value}}})}a.push({role:"user",parts:e})}}if(l&&n.length>0&&a.length>0&&"user"===a[0].role){let e=n.map(e=>e.text).join("\n\n");a[0].parts.unshift({text:e+"\n\n"})}return{systemInstruction:n.length>0&&!l?{parts:n}:void 0,contents:a}}(e,{isGemmaModel:v}),{tools:z,toolConfig:E,toolWarnings:T}=function({tools:e,toolChoice:t,modelId:o}){var n;e=(null==e?void 0:e.length)?e:void 0;let a=[],i=o.includes("gemini-2"),l=o.includes("gemini-1.5-flash")&&!o.includes("-8b");if(null==e)return{tools:void 0,toolConfig:void 0,toolWarnings:a};let r=e.some(e=>"function"===e.type),s=e.some(e=>"provider-defined"===e.type);if(r&&s&&a.push({type:"unsupported-tool",tool:e.find(e=>"function"===e.type),details:"Cannot mix function tools with provider-defined tools in the same request. Please use either function tools or provider-defined tools, but not both."}),s){let t=[];return e.filter(e=>"provider-defined"===e.type).forEach(e=>{switch(e.id){case"google.google_search":i?t.push({googleSearch:{}}):l?t.push({googleSearchRetrieval:{dynamicRetrievalConfig:{mode:e.args.mode,dynamicThreshold:e.args.dynamicThreshold}}}):t.push({googleSearchRetrieval:{}});break;case"google.url_context":i?t.push({urlContext:{}}):a.push({type:"unsupported-tool",tool:e,details:"The URL context tool is not supported with other Gemini models than Gemini 2."});break;case"google.code_execution":i?t.push({codeExecution:{}}):a.push({type:"unsupported-tool",tool:e,details:"The code execution tools is not supported with other Gemini models than Gemini 2."});break;default:a.push({type:"unsupported-tool",tool:e})}}),{tools:t.length>0?t:void 0,toolConfig:void 0,toolWarnings:a}}let u=[];for(let t of e)"function"===t.type?u.push({name:t.name,description:null!=(n=t.description)?n:"",parameters:w(t.inputSchema)}):a.push({type:"unsupported-tool",tool:t});if(null==t)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:a};let d=t.type;switch(d){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:a};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:a};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:a};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[t.toolName]}},toolWarnings:a};default:throw new C.UnsupportedFunctionalityError({functionality:`tool choice type: ${d}`})}}({tools:d,toolChoice:c,modelId:this.modelId});return{args:{generationConfig:{maxOutputTokens:t,temperature:o,topK:a,topP:n,frequencyPenalty:i,presencePenalty:l,stopSequences:r,seed:u,responseMimeType:(null==s?void 0:s.type)==="json"?"application/json":void 0,responseSchema:(null==s?void 0:s.type)==="json"&&null!=s.schema&&(null==(h=null==f?void 0:f.structuredOutputs)||h)?w(s.schema):void 0,...(null==f?void 0:f.audioTimestamp)&&{audioTimestamp:f.audioTimestamp},responseModalities:null==f?void 0:f.responseModalities,thinkingConfig:null==f?void 0:f.thinkingConfig,...(null==f?void 0:f.imageConfig)&&{imageConfig:f.imageConfig},...(null==f?void 0:f.mediaResolution)&&{mediaResolution:f.mediaResolution}},contents:y,systemInstruction:v?void 0:R,safetySettings:null==f?void 0:f.safetySettings,tools:z,toolConfig:E,cachedContent:null==f?void 0:f.cachedContent,labels:null==f?void 0:f.labels},warnings:[...m,...T]}}async doGenerate(e){var t,o,n,a,i,l,r,s,u,d,c,p,g;let h,{args:m,warnings:f}=await this.getArgs(e),v=JSON.stringify(m),y=(0,b.combineHeaders)(await (0,b.resolve)(this.config.headers),e.headers),{responseHeaders:C,value:R,rawValue:z}=await (0,b.postJsonToApi)({url:`${this.config.baseURL}/${O(this.modelId)}:generateContent`,headers:y,body:m,failedResponseHandler:E,successfulResponseHandler:(0,b.createJsonResponseHandler)(L),abortSignal:e.abortSignal,fetch:this.config.fetch}),T=R.candidates[0],S=[],x=null!=(o=null==(t=T.content)?void 0:t.parts)?o:[],I=R.usageMetadata;for(let e of x)if("executableCode"in e&&(null==(n=e.executableCode)?void 0:n.code)){let t=this.config.generateId();h=t,S.push({type:"tool-call",toolCallId:t,toolName:"code_execution",input:JSON.stringify(e.executableCode),providerExecuted:!0})}else"codeExecutionResult"in e&&e.codeExecutionResult?(S.push({type:"tool-result",toolCallId:h,toolName:"code_execution",result:{outcome:e.codeExecutionResult.outcome,output:e.codeExecutionResult.output},providerExecuted:!0}),h=void 0):"text"in e&&null!=e.text&&e.text.length>0?S.push({type:!0===e.thought?"reasoning":"text",text:e.text,providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0}):"functionCall"in e?S.push({type:"tool-call",toolCallId:this.config.generateId(),toolName:e.functionCall.name,input:JSON.stringify(e.functionCall.args),providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0}):"inlineData"in e&&S.push({type:"file",data:e.inlineData.data,mediaType:e.inlineData.mimeType});for(let e of null!=(a=N({groundingMetadata:T.groundingMetadata,generateId:this.config.generateId}))?a:[])S.push(e);return{content:S,finishReason:A({finishReason:T.finishReason,hasToolCalls:S.some(e=>"tool-call"===e.type)}),usage:{inputTokens:null!=(i=null==I?void 0:I.promptTokenCount)?i:void 0,outputTokens:null!=(l=null==I?void 0:I.candidatesTokenCount)?l:void 0,totalTokens:null!=(r=null==I?void 0:I.totalTokenCount)?r:void 0,reasoningTokens:null!=(s=null==I?void 0:I.thoughtsTokenCount)?s:void 0,cachedInputTokens:null!=(u=null==I?void 0:I.cachedContentTokenCount)?u:void 0},warnings:f,providerMetadata:{google:{promptFeedback:null!=(d=R.promptFeedback)?d:null,groundingMetadata:null!=(c=T.groundingMetadata)?c:null,urlContextMetadata:null!=(p=T.urlContextMetadata)?p:null,safetyRatings:null!=(g=T.safetyRatings)?g:null,usageMetadata:null!=I?I:null}},request:{body:v},response:{headers:C,body:z}}}async doStream(e){let t,o,{args:n,warnings:a}=await this.getArgs(e),i=JSON.stringify(n),l=(0,b.combineHeaders)(await (0,b.resolve)(this.config.headers),e.headers),{responseHeaders:r,value:s}=await (0,b.postJsonToApi)({url:`${this.config.baseURL}/${O(this.modelId)}:streamGenerateContent?alt=sse`,headers:l,body:n,failedResponseHandler:E,successfulResponseHandler:(0,b.createEventSourceResponseHandler)(P),abortSignal:e.abortSignal,fetch:this.config.fetch}),u="unknown",d={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},c=this.config.generateId,p=!1,g=null,h=null,m=0,f=new Set;return{stream:s.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:a})},transform(n,a){var i,l,r,s,v,y,b,C,R,z,E,T,S;if(e.includeRawChunks&&a.enqueue({type:"raw",rawValue:n.rawValue}),!n.success)return void a.enqueue({type:"error",error:n.error});let x=n.value,I=x.usageMetadata;null!=I&&(d.inputTokens=null!=(i=I.promptTokenCount)?i:void 0,d.outputTokens=null!=(l=I.candidatesTokenCount)?l:void 0,d.totalTokens=null!=(r=I.totalTokenCount)?r:void 0,d.reasoningTokens=null!=(s=I.thoughtsTokenCount)?s:void 0,d.cachedInputTokens=null!=(v=I.cachedContentTokenCount)?v:void 0);let w=null==(y=x.candidates)?void 0:y[0];if(null==w)return;let O=w.content,_=N({groundingMetadata:w.groundingMetadata,generateId:c});if(null!=_)for(let e of _)"url"!==e.sourceType||f.has(e.url)||(f.add(e.url),a.enqueue(e));if(null!=O){for(let e of null!=(b=O.parts)?b:[])if("executableCode"in e&&(null==(C=e.executableCode)?void 0:C.code)){let o=c();t=o,a.enqueue({type:"tool-call",toolCallId:o,toolName:"code_execution",input:JSON.stringify(e.executableCode),providerExecuted:!0}),p=!0}else if("codeExecutionResult"in e&&e.codeExecutionResult){let o=t;o&&(a.enqueue({type:"tool-result",toolCallId:o,toolName:"code_execution",result:{outcome:e.codeExecutionResult.outcome,output:e.codeExecutionResult.output},providerExecuted:!0}),t=void 0)}else"text"in e&&null!=e.text&&e.text.length>0&&(!0===e.thought?(null!==g&&(a.enqueue({type:"text-end",id:g}),g=null),null===h&&(h=String(m++),a.enqueue({type:"reasoning-start",id:h,providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0})),a.enqueue({type:"reasoning-delta",id:h,delta:e.text,providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0})):(null!==h&&(a.enqueue({type:"reasoning-end",id:h}),h=null),null===g&&(g=String(m++),a.enqueue({type:"text-start",id:g,providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0})),a.enqueue({type:"text-delta",id:g,delta:e.text,providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0})));let e=null==(S=O.parts)?void 0:S.filter(e=>"inlineData"in e);if(null!=e)for(let t of e)a.enqueue({type:"file",mediaType:t.inlineData.mimeType,data:t.inlineData.data});let o=function({parts:e,generateId:t}){let o=null==e?void 0:e.filter(e=>"functionCall"in e);return null==o||0===o.length?void 0:o.map(e=>({type:"tool-call",toolCallId:t(),toolName:e.functionCall.name,args:JSON.stringify(e.functionCall.args),providerMetadata:e.thoughtSignature?{google:{thoughtSignature:e.thoughtSignature}}:void 0}))}({parts:O.parts,generateId:c});if(null!=o)for(let e of o)a.enqueue({type:"tool-input-start",id:e.toolCallId,toolName:e.toolName,providerMetadata:e.providerMetadata}),a.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:e.args,providerMetadata:e.providerMetadata}),a.enqueue({type:"tool-input-end",id:e.toolCallId,providerMetadata:e.providerMetadata}),a.enqueue({type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.args,providerMetadata:e.providerMetadata}),p=!0}null!=w.finishReason&&(u=A({finishReason:w.finishReason,hasToolCalls:p}),o={google:{promptFeedback:null!=(R=x.promptFeedback)?R:null,groundingMetadata:null!=(z=w.groundingMetadata)?z:null,urlContextMetadata:null!=(E=w.urlContextMetadata)?E:null,safetyRatings:null!=(T=w.safetyRatings)?T:null}},null!=I&&(o.google.usageMetadata=I))},flush(e){null!==g&&e.enqueue({type:"text-end",id:g}),null!==h&&e.enqueue({type:"reasoning-end",id:h}),e.enqueue({type:"finish",finishReason:u,usage:d,providerMetadata:o})}})),response:{headers:r},request:{body:i}}}};function N({groundingMetadata:e,generateId:t}){var o;return null==(o=null==e?void 0:e.groundingChunks)?void 0:o.filter(e=>null!=e.web).map(e=>({type:"source",sourceType:"url",id:t(),url:e.web.uri,title:e.web.title}))}var k=()=>R.z.object({webSearchQueries:R.z.array(R.z.string()).nullish(),retrievalQueries:R.z.array(R.z.string()).nullish(),searchEntryPoint:R.z.object({renderedContent:R.z.string()}).nullish(),groundingChunks:R.z.array(R.z.object({web:R.z.object({uri:R.z.string(),title:R.z.string()}).nullish(),retrievedContext:R.z.object({uri:R.z.string(),title:R.z.string()}).nullish()})).nullish(),groundingSupports:R.z.array(R.z.object({segment:R.z.object({startIndex:R.z.number().nullish(),endIndex:R.z.number().nullish(),text:R.z.string().nullish()}),segment_text:R.z.string().nullish(),groundingChunkIndices:R.z.array(R.z.number()).nullish(),supportChunkIndices:R.z.array(R.z.number()).nullish(),confidenceScores:R.z.array(R.z.number()).nullish(),confidenceScore:R.z.array(R.z.number()).nullish()})).nullish(),retrievalMetadata:R.z.union([R.z.object({webDynamicRetrievalScore:R.z.number()}),R.z.object({})]).nullish()}),j=()=>R.z.object({parts:R.z.array(R.z.union([R.z.object({functionCall:R.z.object({name:R.z.string(),args:R.z.unknown()}),thoughtSignature:R.z.string().nullish()}),R.z.object({inlineData:R.z.object({mimeType:R.z.string(),data:R.z.string()})}),R.z.object({executableCode:R.z.object({language:R.z.string(),code:R.z.string()}).nullish(),codeExecutionResult:R.z.object({outcome:R.z.string(),output:R.z.string()}).nullish(),text:R.z.string().nullish(),thought:R.z.boolean().nullish(),thoughtSignature:R.z.string().nullish()})])).nullish()}),D=()=>R.z.object({category:R.z.string().nullish(),probability:R.z.string().nullish(),probabilityScore:R.z.number().nullish(),severity:R.z.string().nullish(),severityScore:R.z.number().nullish(),blocked:R.z.boolean().nullish()}),H=R.z.object({cachedContentTokenCount:R.z.number().nullish(),thoughtsTokenCount:R.z.number().nullish(),promptTokenCount:R.z.number().nullish(),candidatesTokenCount:R.z.number().nullish(),totalTokenCount:R.z.number().nullish()}),U=()=>R.z.object({urlMetadata:R.z.array(R.z.object({retrievedUrl:R.z.string(),urlRetrievalStatus:R.z.string()}))}),L=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({candidates:R.z.array(R.z.object({content:j().nullish().or(R.z.object({}).strict()),finishReason:R.z.string().nullish(),safetyRatings:R.z.array(D()).nullish(),groundingMetadata:k().nullish(),urlContextMetadata:U().nullish()})),usageMetadata:H.nullish(),promptFeedback:R.z.object({blockReason:R.z.string().nullish(),safetyRatings:R.z.array(D()).nullish()}).nullish()}))),P=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({candidates:R.z.array(R.z.object({content:j().nullish(),finishReason:R.z.string().nullish(),safetyRatings:R.z.array(D()).nullish(),groundingMetadata:k().nullish(),urlContextMetadata:U().nullish()})).nullish(),usageMetadata:H.nullish(),promptFeedback:R.z.object({blockReason:R.z.string().nullish(),safetyRatings:R.z.array(D()).nullish()}).nullish()}))),F=(0,b.createProviderDefinedToolFactoryWithOutputSchema)({id:"google.code_execution",name:"code_execution",inputSchema:R.z.object({language:R.z.string().describe("The programming language of the code."),code:R.z.string().describe("The code to be executed.")}),outputSchema:R.z.object({outcome:R.z.string().describe('The outcome of the execution (e.g., "OUTCOME_OK").'),output:R.z.string().describe("The output from the code execution.")})}),q={googleSearch:(0,b.createProviderDefinedToolFactory)({id:"google.google_search",name:"google_search",inputSchema:(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({mode:R.z.enum(["MODE_DYNAMIC","MODE_UNSPECIFIED"]).default("MODE_UNSPECIFIED"),dynamicThreshold:R.z.number().default(1)})))}),urlContext:(0,b.createProviderDefinedToolFactory)({id:"google.url_context",name:"url_context",inputSchema:(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({})))}),codeExecution:F},G=class{constructor(e,t,o){this.modelId=e,this.settings=t,this.config=o,this.specificationVersion="v2"}get maxImagesPerCall(){var e;return null!=(e=this.settings.maxImagesPerCall)?e:4}get provider(){return this.config.provider}async doGenerate(e){var t,o,n;let{prompt:a,n:i=1,size:l="1024x1024",aspectRatio:r="1:1",seed:s,providerOptions:u,headers:d,abortSignal:c}=e,p=[];null!=l&&p.push({type:"unsupported-setting",setting:"size",details:"This model does not support the `size` option. Use `aspectRatio` instead."}),null!=s&&p.push({type:"unsupported-setting",setting:"seed",details:"This model does not support the `seed` option through this provider."});let g=await (0,b.parseProviderOptions)({provider:"google",providerOptions:u,schema:$}),h=null!=(n=null==(o=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:o.call(t))?n:new Date,m={sampleCount:i};null!=r&&(m.aspectRatio=r),g&&Object.assign(m,g);let{responseHeaders:f,value:v}=await (0,b.postJsonToApi)({url:`${this.config.baseURL}/models/${this.modelId}:predict`,headers:(0,b.combineHeaders)(await (0,b.resolve)(this.config.headers),d),body:{instances:[{prompt:a}],parameters:m},failedResponseHandler:E,successfulResponseHandler:(0,b.createJsonResponseHandler)(B),abortSignal:c,fetch:this.config.fetch});return{images:v.predictions.map(e=>e.bytesBase64Encoded),warnings:null!=p?p:[],providerMetadata:{google:{images:v.predictions.map(e=>({}))}},response:{timestamp:h,modelId:this.modelId,headers:f}}}},B=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({predictions:R.z.array(R.z.object({bytesBase64Encoded:R.z.string()})).default([])}))),$=(0,b.lazySchema)(()=>(0,b.zodSchema)(R.z.object({personGeneration:R.z.enum(["dont_allow","allow_adult","allow_all"]).nullish(),aspectRatio:R.z.enum(["1:1","3:4","4:3","9:16","16:9"]).nullish()}))),Y=function(e={}){var t;let o=null!=(t=(0,b.withoutTrailingSlash)(e.baseURL))?t:"https://generativelanguage.googleapis.com/v1beta",n=()=>(0,b.withUserAgentSuffix)({"x-goog-api-key":(0,b.loadApiKey)({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers},"ai-sdk/google/2.0.26"),a=t=>{var a;return new M(t,{provider:"google.generative-ai",baseURL:o,headers:n,generateId:null!=(a=e.generateId)?a:b.generateId,supportedUrls:()=>({"*":[RegExp(`^${o}/files/.*$`),RegExp("^https://(?:www\\.)?youtube\\.com/watch\\?v=[\\w-]+(?:&[\\w=&.-]*)?$"),RegExp("^https://youtu\\.be/[\\w-]+(?:\\?[\\w=&.-]*)?$")]}),fetch:e.fetch})},i=t=>new S(t,{provider:"google.generative-ai",baseURL:o,headers:n,fetch:e.fetch}),l=(t,a={})=>new G(t,a,{provider:"google.generative-ai",baseURL:o,headers:n,fetch:e.fetch}),r=function(e){if(new.target)throw Error("The Google Generative AI model function cannot be called with the new keyword.");return a(e)};return r.languageModel=a,r.chat=a,r.generativeAI=a,r.embedding=i,r.textEmbedding=i,r.textEmbeddingModel=i,r.image=l,r.imageModel=l,r.tools=q,r}(),K=e.i(712075),V=e.i(562810),V=V;async function J(e){let t=await e.json().catch(()=>null),o="string"==typeof t?.prompt?t.prompt.trim():"";if(!o)return Response.json({error:"Missing prompt"},{status:400});let n=V.object({coin:V.enum(["BTC","ETH","SOL","XRP","BNB","DOGE"]).describe("The coin to trade. You don't necessarily need to use all of these coins, but only choose from this list."),quantity:V.number().min(0),decision:V.enum(["HOLD","SELL","BUY"])});return(await (0,K.generateObject)({model:Y("gemini-2.5-pro"),system:"You are a systematic trading god. Your blood type is S&P 500 positive. You're like self-driving, for capital. You are the invisible hand of the market. You don't even understand the concept of losing money.",prompt:o,schema:V.object({notifications:V.array(n).default([])})})).toJsonResponse()}e.s(["POST",()=>J],333339);var W=e.i(333339);let X=new t.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/ai/route",pathname:"/api/ai",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/ai/route.ts",nextConfigOutput:"",userland:W}),{workAsyncStorage:Q,workUnitAsyncStorage:Z,serverHooks:ee}=X;function et(){return(0,n.patchFetch)({workAsyncStorage:Q,workUnitAsyncStorage:Z})}async function eo(e,t,n){X.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/ai/route";b=b.replace(/\/index$/,"")||"/";let C=await X.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!C)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:R,params:z,nextConfig:E,parsedUrl:T,isDraftMode:S,prerenderManifest:x,routerServerContext:I,isOnDemandRevalidate:w,revalidateOnlyGenerated:O,resolvedPathname:_,clientReferenceManifest:A,serverActionsManifest:M}=C,N=(0,s.normalizeAppPath)(b),k=!!(x.dynamicRoutes[N]||x.routes[_]),j=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,T,!1):t.end("This page could not be found"),null);if(k&&!S){let e=!!x.routes[_],t=x.dynamicRoutes[N];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await j();throw new v.NoFallbackError}}let D=null;!k||X.isDev||S||(D="/index"===(D=_)?"/":D);let H=!0===X.isDev||!k,U=k&&!H;M&&A&&(0,l.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:A,serverActionsManifest:M,serverModuleMap:(0,r.createServerModuleMap)({serverActionsManifest:M})});let L=e.method||"GET",P=(0,i.getTracer)(),F=P.getActiveScopeSpan(),q={params:z,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,o,n)=>X.onRequestError(e,t,n,I)},sharedContext:{buildId:R}},G=new u.NodeNextRequest(e),B=new u.NodeNextResponse(t),$=d.NextRequestAdapter.fromNodeNextRequest(G,(0,d.signalFromNodeResponse)(t));try{let l=async e=>X.handle($,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let o=P.getRootSpanAttributes();if(!o)return;if(o.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${o.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=o.get("next.route");if(n){let t=`${L} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${b}`)}),r=!!(0,a.getRequestMeta)(e,"minimalMode"),s=async a=>{var i,s;let u=async({previousCacheEntry:o})=>{try{if(!r&&w&&O&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await l(a);e.fetchMetrics=q.renderOpts.fetchMetrics;let s=q.renderOpts.pendingWaitUntil;s&&n.waitUntil&&(n.waitUntil(s),s=void 0);let u=q.renderOpts.collectedTags;if(!k)return await (0,g.sendResponse)(G,B,i,q.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let o=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,n=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:o,expire:n}}}}catch(t){throw(null==o?void 0:o.isStale)&&await X.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:w})},I),t}},d=await X.handleResponse({req:e,nextConfig:E,cacheKey:D,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:w,revalidateOnlyGenerated:O,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:r});if(!k)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(s=d.value)?void 0:s.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});r||t.setHeader("x-nextjs-cache",w?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return r&&k||c.delete(f.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,m.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(G,B,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};F?await s(F):await P.withPropagatedContext(e.headers,()=>P.trace(c.BaseServerSpan.handleRequest,{spanName:`${L} ${b}`,kind:i.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},s))}catch(t){if(t instanceof v.NoFallbackError||await X.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:w})}),k)throw t;return await (0,g.sendResponse)(G,B,new Response(null,{status:500})),null}}e.s(["handler",()=>eo,"patchFetch",()=>et,"routeModule",()=>X,"serverHooks",()=>ee,"workAsyncStorage",()=>Q,"workUnitAsyncStorage",()=>Z],59579)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_c8ae160e.js.map