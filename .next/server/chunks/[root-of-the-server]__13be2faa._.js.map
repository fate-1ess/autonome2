{"version":3,"sources":["turbopack:///[project]/node_modules/@vercel/oidc/dist/token-error.js","turbopack:///[project]/src/server/db/prisma.ts","turbopack:///[project]/src/lib/utils/json.ts","turbopack:///[project]/src/lib/tradingDecisions.ts","turbopack:///[project]/src/lib/getPortfolio.ts","turbopack:///[project]/src/lib/openPositions.ts"],"sourcesContent":["\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\nvar token_error_exports = {};\n__export(token_error_exports, {\n  VercelOidcTokenError: () => VercelOidcTokenError\n});\nmodule.exports = __toCommonJS(token_error_exports);\nclass VercelOidcTokenError extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"VercelOidcTokenError\";\n    this.cause = cause;\n  }\n  toString() {\n    if (this.cause) {\n      return `${this.name}: ${this.message}: ${this.cause}`;\n    }\n    return `${this.name}: ${this.message}`;\n  }\n}\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  VercelOidcTokenError\n});\n","import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  globalForPrisma.prisma = prisma;\r\n}\r\n","export const isRecord = (value: unknown): value is Record<string, unknown> => {\r\n  return typeof value === \"object\" && value !== null && !Array.isArray(value);\r\n};\r\n\r\nexport const safeJsonParse = <T>(\r\n  value: string | null | undefined,\r\n  fallback: T,\r\n): T => {\r\n  if (!value) {\r\n    return fallback;\r\n  }\r\n\r\n  try {\r\n    const parsed = JSON.parse(value) as unknown;\r\n    return (parsed ?? fallback) as T;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n};\r\n\r\nexport const getArray = <T>(value: unknown): T[] => {\r\n  return Array.isArray(value) ? (value as T[]) : [];\r\n};\r\n","export type TradingSignal = \"LONG\" | \"SHORT\" | \"HOLD\";\r\n\r\nexport interface TradingDecision {\r\n  symbol: string;\r\n  signal: TradingSignal;\r\n  quantity: number | null;\r\n  leverage: number | null;\r\n  profitTarget: number | null;\r\n  stopLoss: number | null;\r\n  invalidationCondition: string | null;\r\n  confidence: number | null;\r\n  status?: string | null;\r\n}\r\n\r\nexport interface TradingDecisionResult {\r\n  symbol: string;\r\n  success: boolean;\r\n  error?: string | null;\r\n}\r\n\r\nexport interface TradingToolCallMetadata {\r\n  decisions: TradingDecision[];\r\n  results: TradingDecisionResult[];\r\n  raw: unknown;\r\n}\r\n\r\nexport interface ToolCallDecisionSource {\r\n  id: string;\r\n  createdAt: Date;\r\n  metadata: unknown;\r\n  toolCallType?: string;\r\n}\r\n\r\nexport interface TradingDecisionWithContext extends TradingDecision {\r\n  toolCallId: string;\r\n  createdAt: Date;\r\n  toolCallType?: string;\r\n  result?: TradingDecisionResult | null;\r\n}\r\n\r\nconst SIGNAL_LOOKUP: Record<string, TradingSignal> = {\r\n  LONG: \"LONG\",\r\n  SHORT: \"SHORT\",\r\n  HOLD: \"HOLD\",\r\n};\r\n\r\nconst toNumber = (value: unknown): number | null => {\r\n  if (value == null) return null;\r\n  if (typeof value === \"number\") {\r\n    return Number.isFinite(value) ? value : null;\r\n  }\r\n  if (typeof value === \"string\" && value.trim().length > 0) {\r\n    const parsed = Number.parseFloat(value);\r\n    return Number.isFinite(parsed) ? parsed : null;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst toStringValue = (value: unknown): string | null => {\r\n  if (typeof value === \"string\") {\r\n    const trimmed = value.trim();\r\n    return trimmed.length > 0 ? trimmed : null;\r\n  }\r\n  if (typeof value === \"number\" && Number.isFinite(value)) {\r\n    return value.toString();\r\n  }\r\n  return null;\r\n};\r\n\r\nconst normalizeSymbol = (value: unknown): string | null => {\r\n  const str = toStringValue(value);\r\n  if (!str) return null;\r\n  return str.toUpperCase();\r\n};\r\n\r\nconst normalizeSignal = (value: unknown): TradingSignal | null => {\r\n  const str = toStringValue(value);\r\n  if (!str) return null;\r\n  const upper = str.toUpperCase();\r\n  if (upper in SIGNAL_LOOKUP) {\r\n    return SIGNAL_LOOKUP[upper];\r\n  }\r\n  return null;\r\n};\r\n\r\nconst parseDecisionCandidate = (value: unknown, fallbackSymbol?: string): TradingDecision | null => {\r\n  if (typeof value !== \"object\" || value === null) return null;\r\n  const record = value as Record<string, unknown>;\r\n\r\n  const symbol = normalizeSymbol(record.symbol ?? record.market ?? fallbackSymbol);\r\n  if (!symbol) return null;\r\n\r\n  const signal = normalizeSignal(record.signal ?? record.side ?? record.action);\r\n  if (!signal) return null;\r\n\r\n  const quantity = toNumber(record.quantity ?? record.size ?? record.notional ?? record.amount);\r\n  const leverage = toNumber(record.leverage ?? record.leverageRatio);\r\n  const profitTarget = toNumber(record.profitTarget ?? record.target ?? record.profit_target);\r\n  const stopLoss = toNumber(record.stopLoss ?? record.stop ?? record.stop_loss);\r\n  const invalidationCondition = toStringValue(record.invalidationCondition ?? record.invalidCondition ?? record.invalid_condition ?? record.invalidation_condition) ?? null;\r\n  const confidence = toNumber(record.confidence ?? record.confidenceScore ?? record.confidence_percent ?? record.confidence_percentage);\r\n  const status = toStringValue(record.status ?? record.executionStatus ?? record.execution_status) ?? null;\r\n\r\n  return {\r\n    symbol,\r\n    signal,\r\n    quantity,\r\n    leverage,\r\n    profitTarget,\r\n    stopLoss,\r\n    invalidationCondition,\r\n    confidence,\r\n    status,\r\n  };\r\n};\r\n\r\nconst parseResultCandidate = (value: unknown, fallbackSymbol?: string): TradingDecisionResult | null => {\r\n  if (typeof value !== \"object\" || value === null) return null;\r\n  const record = value as Record<string, unknown>;\r\n\r\n  const symbol = normalizeSymbol(record.symbol ?? fallbackSymbol);\r\n  if (!symbol) return null;\r\n\r\n  const successValue = record.success ?? record.ok ?? record.executed;\r\n  const success = typeof successValue === \"boolean\" ? successValue : successValue === 1 || successValue === \"true\";\r\n  const error = toStringValue(record.error ?? record.reason ?? record.message) ?? null;\r\n\r\n  return { symbol, success, error };\r\n};\r\n\r\nconst collectDecisionArrays = (raw: Record<string, unknown>): unknown[] => {\r\n  const collections: unknown[] = [];\r\n  const candidateKeys = [\r\n    \"decisions\",\r\n    \"positions\",\r\n    \"actions\",\r\n    \"entries\",\r\n    \"closedPositions\",\r\n    \"signals\",\r\n  ];\r\n\r\n  for (const key of candidateKeys) {\r\n    const value = raw[key];\r\n    if (Array.isArray(value)) {\r\n      collections.push(value);\r\n    }\r\n  }\r\n\r\n  return collections;\r\n};\r\n\r\nconst collectResultArrays = (raw: Record<string, unknown>): unknown[] => {\r\n  const collections: unknown[] = [];\r\n  const candidateKeys = [\r\n    \"results\",\r\n    \"executions\",\r\n    \"outcomes\",\r\n    \"closedPositions\",\r\n  ];\r\n\r\n  for (const key of candidateKeys) {\r\n    const value = raw[key];\r\n    if (Array.isArray(value)) {\r\n      collections.push(value);\r\n    }\r\n  }\r\n\r\n  return collections;\r\n};\r\n\r\nexport const parseTradingToolCallMetadata = (raw: unknown): TradingToolCallMetadata => {\r\n  if (typeof raw !== \"object\" || raw === null) {\r\n    return { decisions: [], results: [], raw };\r\n  }\r\n\r\n  const record = raw as Record<string, unknown>;\r\n  const decisions: TradingDecision[] = [];\r\n\r\n  for (const collection of collectDecisionArrays(record)) {\r\n    if (!Array.isArray(collection)) continue;\r\n    for (const item of collection) {\r\n      const decision = parseDecisionCandidate(item);\r\n      if (decision) {\r\n        decisions.push(decision);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Some metadata uses a single object instead of an array\r\n  if (decisions.length === 0) {\r\n    const fallbackDecision = parseDecisionCandidate(record);\r\n    if (fallbackDecision) {\r\n      decisions.push(fallbackDecision);\r\n    }\r\n  }\r\n\r\n  const results: TradingDecisionResult[] = [];\r\n  for (const collection of collectResultArrays(record)) {\r\n    if (!Array.isArray(collection)) continue;\r\n    for (const item of collection) {\r\n      const result = parseResultCandidate(item);\r\n      if (result) {\r\n        results.push(result);\r\n      }\r\n    }\r\n  }\r\n\r\n  return { decisions, results, raw };\r\n};\r\n\r\nexport const buildDecisionIndex = (toolCalls: ToolCallDecisionSource[]): Map<string, TradingDecisionWithContext> => {\r\n  const index = new Map<string, TradingDecisionWithContext>();\r\n\r\n  for (const toolCall of toolCalls) {\r\n    const parsed = parseTradingToolCallMetadata(toolCall.metadata);\r\n    if (!parsed.decisions.length) continue;\r\n\r\n    const resultLookup = new Map<string, TradingDecisionResult>();\r\n    for (const result of parsed.results) {\r\n      resultLookup.set(result.symbol, result);\r\n    }\r\n\r\n    for (const decision of parsed.decisions) {\r\n      const key = decision.symbol;\r\n      if (!key || index.has(key)) {\r\n        continue;\r\n      }\r\n\r\n      index.set(key, {\r\n        ...decision,\r\n        toolCallId: toolCall.id,\r\n        createdAt: toolCall.createdAt,\r\n        toolCallType: toolCall.toolCallType,\r\n        result: resultLookup.get(key) ?? null,\r\n      });\r\n    }\r\n  }\r\n\r\n  return index;\r\n};\r\n","import { AccountApi, ApiKeyAuthentication, IsomorphicFetchHttpLibrary, ServerConfiguration } from \"../../lighter-sdk-ts/generated\";\r\nimport type { Account } from \"./accounts\";\r\nimport { BASE_URL, DEFAULT_SIMULATOR_OPTIONS, IS_SIMULATION_ENABLED } from \"./config\";\r\nimport { ExchangeSimulator } from \"./simulator/exchangeSimulator\";\r\n\r\nexport type PortfolioSnapshot = {\r\n    totalValue: number;\r\n    availableCash: number;\r\n    total: string;\r\n    available: string;\r\n};\r\n\r\nconst normalizeNumber = (value: unknown): number | null => {\r\n    if (typeof value === \"number\") {\r\n        return Number.isFinite(value) ? value : null;\r\n    }\r\n    if (typeof value === \"string\" && value.trim().length > 0) {\r\n        const parsed = Number.parseFloat(value);\r\n        return Number.isFinite(parsed) ? parsed : null;\r\n    }\r\n    return null;\r\n};\r\n\r\nconst formatCurrencyString = (value: number): string => value.toFixed(2);\r\n\r\nasync function buildSimulatorPortfolio(account: Account): Promise<PortfolioSnapshot> {\r\n    const simulator = await ExchangeSimulator.bootstrap(DEFAULT_SIMULATOR_OPTIONS);\r\n    const accountId = account.id || \"default\";\r\n    const snapshot = simulator.getAccountSnapshot(accountId);\r\n\r\n    const equityValue = Number.isFinite(snapshot.equity) ? snapshot.equity : 0;\r\n    const usableFromSnapshot = Number.isFinite(snapshot.availableCash) ? snapshot.availableCash : undefined;\r\n    const fallbackUsable = Math.min(snapshot.cashBalance, equityValue);\r\n    const availableCash = Math.max(usableFromSnapshot ?? fallbackUsable, 0);\r\n\r\n    return {\r\n        totalValue: equityValue,\r\n        availableCash,\r\n        total: formatCurrencyString(equityValue),\r\n        available: formatCurrencyString(availableCash),\r\n    };\r\n}\r\n\r\ntype PortfolioOptions = {\r\n    fallbackToSimulator?: boolean;\r\n};\r\n\r\nexport async function getPortfolio(account: Account, options?: PortfolioOptions): Promise<PortfolioSnapshot> {\r\n    const fallbackToSimulator = options?.fallbackToSimulator ?? false;\r\n\r\n    if (IS_SIMULATION_ENABLED) {\r\n        return buildSimulatorPortfolio(account);\r\n    }\r\n\r\n    if (!account.apiKey || account.apiKey.trim().length === 0) {\r\n        if (fallbackToSimulator) {\r\n            console.warn(`[getPortfolio] Missing API key for account ${account.accountIndex}; using simulator fallback.`);\r\n            return buildSimulatorPortfolio(account);\r\n        }\r\n        throw new Error(`Missing API key for account index ${account.accountIndex}`);\r\n    }\r\n\r\n    const accountApi = new AccountApi({\r\n        baseServer: new ServerConfiguration<{ }>(BASE_URL, { }),\r\n        httpApi: new IsomorphicFetchHttpLibrary(),\r\n        middleware: [],\r\n        authMethods: {\r\n            apiKey: new ApiKeyAuthentication(account.apiKey),\r\n        },\r\n    });\r\n\r\n    try {\r\n        const response = await accountApi.accountWithHttpInfo(\"index\", account.accountIndex);\r\n        const accountData = (response.data?.accounts?.[0] ?? {}) as Record<string, unknown>;\r\n        const totalValue =\r\n            normalizeNumber(\r\n                accountData[\"totalAssetValue\"] ?? accountData[\"total_asset_value\"] ?? accountData[\"total\"],\r\n            ) ?? 0;\r\n        const rawAvailable = normalizeNumber(\r\n            accountData[\"availableBalance\"] ?? accountData[\"available_balance\"] ?? accountData[\"available\"],\r\n        );\r\n\r\n        const cappedAvailable =\r\n            totalValue > 0 && rawAvailable != null\r\n                ? Math.min(rawAvailable, totalValue)\r\n                : rawAvailable ?? totalValue;\r\n\r\n        const availableCash = Math.max(cappedAvailable ?? 0, 0);\r\n\r\n        return {\r\n            totalValue,\r\n            availableCash,\r\n            total: formatCurrencyString(totalValue),\r\n            available: formatCurrencyString(availableCash),\r\n        };\r\n    } catch (error) {\r\n        if (fallbackToSimulator) {\r\n            console.warn(\r\n                `[getPortfolio] Failed to fetch live portfolio for account ${account.accountIndex}, using simulator fallback`,\r\n                error instanceof Error ? error.message : error,\r\n            );\r\n            return buildSimulatorPortfolio(account);\r\n        }\r\n        throw error;\r\n    }\r\n}","import { AccountApi, ApiKeyAuthentication, IsomorphicFetchHttpLibrary, ServerConfiguration } from \"../../lighter-sdk-ts/generated\";\r\nimport { BASE_URL, DEFAULT_SIMULATOR_OPTIONS, IS_SIMULATION_ENABLED } from \"./config\";\r\nimport { ExchangeSimulator } from \"./simulator/exchangeSimulator\";\r\nimport type { TradingSignal } from \"./tradingDecisions\";\r\n\r\nexport interface ExitPlanSummary {\r\n  target: number | null;\r\n  stop: number | null;\r\n  invalidation: string | null;\r\n}\r\n\r\nexport interface OpenPositionSummary {\r\n  symbol: string;\r\n  position: string;\r\n  quantity: number;\r\n  sign: \"LONG\" | \"SHORT\";\r\n  unrealizedPnl: string;\r\n  realizedPnl: string;\r\n  liquidationPrice: string | null;\r\n  leverage?: number;\r\n  notional?: string;\r\n  entryPrice?: number | null;\r\n  markPrice?: number | null;\r\n  exitPlan?: ExitPlanSummary | null;\r\n  confidence?: number | null;\r\n  signal?: TradingSignal;\r\n  lastDecisionAt?: string | null;\r\n  decisionStatus?: string | null;\r\n}\r\n\r\nconst toNumber = (value: unknown): number | null => {\r\n  if (typeof value === \"number\") return Number.isFinite(value) ? value : null;\r\n  if (typeof value === \"string\") {\r\n    const parsed = Number.parseFloat(value);\r\n    return Number.isFinite(parsed) ? parsed : null;\r\n  }\r\n  return null;\r\n};\r\n\r\nasync function buildSimulatorPositions(accountId?: string): Promise<OpenPositionSummary[]> {\r\n  const simulator = await ExchangeSimulator.bootstrap(DEFAULT_SIMULATOR_OPTIONS);\r\n  const simulatorAccountId = accountId && accountId.length > 0 ? accountId : \"default\";\r\n\r\n  return simulator.getOpenPositions(simulatorAccountId).map((position) => {\r\n    const quantity = position.quantity;\r\n    const entryPrice = position.avgEntryPrice ?? null;\r\n    const notionalEntry = Number.isFinite(position.notional)\r\n      ? position.notional\r\n      : entryPrice != null\r\n        ? entryPrice * Math.abs(quantity)\r\n        : position.markPrice != null\r\n          ? position.markPrice * Math.abs(quantity)\r\n          : null;\r\n    const leverage = position.leverage != null && Number.isFinite(position.leverage) ? position.leverage : undefined;\r\n\r\n    return {\r\n      symbol: position.symbol,\r\n      position: position.quantity.toFixed(4),\r\n      quantity,\r\n      sign: position.side,\r\n      unrealizedPnl: position.unrealizedPnl.toFixed(2),\r\n      realizedPnl: position.realizedPnl.toFixed(2),\r\n      liquidationPrice: null,\r\n      leverage,\r\n      notional: notionalEntry != null ? notionalEntry.toFixed(2) : undefined,\r\n      entryPrice,\r\n      markPrice: position.markPrice ?? null,\r\n      exitPlan: null,\r\n      confidence: null,\r\n      signal: position.side,\r\n      lastDecisionAt: null,\r\n      decisionStatus: null,\r\n    };\r\n  });\r\n}\r\n\r\ntype OpenPositionOptions = {\r\n  fallbackToSimulator?: boolean;\r\n};\r\n\r\nexport async function getOpenPositions(\r\n  apiKey: string,\r\n  accountIndex: string,\r\n  accountId?: string,\r\n  options?: OpenPositionOptions,\r\n): Promise<OpenPositionSummary[]> {\r\n  const fallbackToSimulator = options?.fallbackToSimulator ?? false;\r\n\r\n  if (IS_SIMULATION_ENABLED) {\r\n    return buildSimulatorPositions(accountId);\r\n  }\r\n\r\n  if (!apiKey || apiKey.trim().length === 0) {\r\n    if (fallbackToSimulator) {\r\n      console.warn(`[openPositions] Missing API key for account ${accountIndex}; using simulator fallback.`);\r\n      return buildSimulatorPositions(accountId);\r\n    }\r\n    throw new Error(`Missing API key for account index ${accountIndex}`);\r\n  }\r\n\r\n  const accountApi = new AccountApi({\r\n    baseServer: new ServerConfiguration<{ }>(BASE_URL, { }),\r\n    httpApi: new IsomorphicFetchHttpLibrary(),\r\n    middleware: [],\r\n    authMethods: {\r\n      apiKey: new ApiKeyAuthentication(apiKey),\r\n    },\r\n  });\r\n\r\n  try {\r\n    const currentOpenOrders = await accountApi.accountWithHttpInfo(\"index\", accountIndex);\r\n    const positions = currentOpenOrders.data.accounts[0]?.positions ?? [];\r\n\r\n    return positions.map((accountPosition) => {\r\n      const quantity = toNumber(accountPosition.position) ?? 0;\r\n      const entryPrice = toNumber(accountPosition.avgEntryPrice);\r\n      const positionValue = toNumber(accountPosition.positionValue);\r\n      const markPrice =\r\n        positionValue != null && quantity !== 0\r\n          ? positionValue / Math.abs(quantity)\r\n          : toNumber(accountPosition.avgEntryPrice);\r\n\r\n      return {\r\n        symbol: accountPosition.symbol,\r\n        position: accountPosition.position,\r\n        quantity,\r\n        sign: accountPosition.sign === 1 ? \"LONG\" : \"SHORT\",\r\n        unrealizedPnl: accountPosition.unrealizedPnl,\r\n        realizedPnl: accountPosition.realizedPnl,\r\n        liquidationPrice: accountPosition.liquidationPrice,\r\n        leverage: undefined,\r\n        notional: accountPosition.positionValue,\r\n        entryPrice,\r\n        markPrice,\r\n        exitPlan: null,\r\n        confidence: null,\r\n        signal: accountPosition.sign === 1 ? \"LONG\" : \"SHORT\",\r\n        lastDecisionAt: null,\r\n        decisionStatus: null,\r\n      };\r\n    });\r\n  } catch (error) {\r\n    if (fallbackToSimulator) {\r\n      console.warn(\r\n        `[openPositions] Failed to load live positions for account ${accountIndex}, using simulator fallback`,\r\n        error instanceof Error ? error.message : error,\r\n      );\r\n      return buildSimulatorPositions(accountId);\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0]}